



<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="../../../../static/img/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <title>Product Details</title>

    <link rel="stylesheet" href="../../../../static/CACHE/css/output.aa5f838efd55.css" type="text/css">
    
    <script type="text/javascript" src="../../../../static/tingle.js/dist/tingle.min.js"></script>


    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-S87G2283KK"></script>
    <script>
        /* eslint-disable */
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-S87G2283KK');
        gtag('config', 'UA-234451190-1');

        /* eslint-enable */
    </script>
</head>
<body class="">
    <header>
        <div class="container navbar-container">
            <div class="pure-g">
                <div class="pure-u-1-2 pure-u-lg-3-5">
                    <div class="pure-g main-menus">
                        <div class="burger-menu desktop-hide ">
                            <input type="checkbox" class="burger-button">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                        <a href="../../../../index.html" class="pure-u-1-2 pure-u-lg-1-3 logo-wrapper">
                            <img src="../../../../static/img/Logo-Harvest-White.png" class="logo">
                        </a>
                        <a href="../../../index.html" class="pure-u-1-8 mobile-hide">
                            <span>MENU</span>
                        </a>
                        <a href="../../../../our-stores/index.html" class="pure-u-1-8 mobile-hide"><span>STORES</span></a>
                        <a href="../../../../rewards/index.html" class="pure-u-1-8 mobile-hide"><span>TREATS</span></a>
                        <a href="../../../../b2b/index.html" class="pure-u-1-8 mobile-hide b2b-link"><span>B2B</span></a>
                    </div>
                </div>
                <div class="pure-u-1-2 pure-u-lg-2-5 vertical-align-middle right search-and-cart">
                    <div class="button-wrapper header-button vertical-align-middle">
                        
                        <div class="search-wrapper mobile-search desktop-hide">
                            <a href="index.html#" class="search-field">
                                <img src="../../../../static/img/Search.png" class="search-icon">
                            </a>
                        </div>
                        
                        <a href="../../../../carts/index.html" class="button cart-button ">
                            
                            
                                <span class="cart-text">CART</span>
                            
                            <img src="../../../../static/img/Cart.png" class="cart-icon">
                            <span class="cart-count">
                                
                            </span>
                            
                        </a>
                        <div class="dropdown-wrapper mobile-hide">
                            
                                <a href="../../../../login/index.html@next=%252Fmenus%252Fhampers%252F1306%252Fessential-cookies-2%252F.html" class="button pink">LOGIN/SIGN UP</a>
                            
                        </div>
                    </div>
                </div>
                
                <form action="https://harvestcakes.com/search/the-harvest-express/" method="get" class="search-wrapper mobile-search-field desktop-hide">
                    <input name="keyword" value="" type="text" placeholder="Search">
                    <button><img src="../../../../static/img/Search.png" class="search-icon"></button>
                    <a href="index.html#" class="search-field website">
                        <img src="../../../../static/img/Search.png" class="search-icon">
                    </a>
                </form>
                

                <div class="pure-u-1-1 vertical-align-middle right website">
                    <div class="location-wrapper mobile-hide">
                        
                        <a href="index.html#" id='open-map' class="deliver">
                            <span>Location <img src="../../../../static/img/Location.png" class="location-icon"></span>
                        </a>
                        
                        <form action="https://harvestcakes.com/search/the-harvest-express/" method="get" class="search-wrapper website-search-wrapper ">
                            <input name="keyword" value="" type="text" placeholder="Search">
                            <button><img src="../../../../static/img/Search.png" class="search-icon"></button>
                            <a href="index.html#" class="search-field website-search">
                                <img src="../../../../static/img/Search.png" class="search-icon">
                            </a>
                        </form>
                    </div>
                </div>
            </div>
            <div class="desktop-hide mobile-nav-items mobile-hide">
                <div class="location-mobile pure-u-1 pure-g">
                    
                    <a href="index.html#" id='open-map' class="button pure-u-1">
                        <span><img src="../../../../static/img/Location.png" class="location-icon"></img></span>
                        Choose Location
                    </a>
                    

                    
                    <a href="../../../../login/index.html@next=%252Fmenus%252Fhampers%252F1306%252Fessential-cookies-2%252F.html" class="button pure-u-1 bg-pink">LOG IN</a>
                    
                </div>

                <div class="location-mobile user-menu-wrapper pure-u-1 pure-g">
                    
                </div>

                <div class="nav-links pure-u-1">
                    <a href="../../../index.html" class="pure-u-1">MENU</a>
                    <a href="../../../../our-stores/index.html" class="pure-u-1">OUR STORES</a>
                    <a href="../../../../rewards/index.html" class="pure-u-1">TREATS</a>
                    <a href="../../../../b2b/index.html" class="pure-u-1">B2B</a>
                </div>
            </div>
        </div>
    </header>

    <div class="container messages-container">
        
    </div>
    
    <!-- Debug purpose -->
    <div id="debug-store-name" class="hide mobile-hide">
        The Harvest Express HQ
    </div>
    
    <div class="content-wrapper-box">
        
<div class="separator medium website"></div>
<div class="separator large mobile"></div>
<div class="container product-details pure-g three-column">
    <div class="breadcrumbs mobile">
        <a href="../../../index.html">Menu</a> > <a href="../../../the-harvest-express/hampers/index.html">Hampers</a>
    </div>
    <div class="pure-u-8-24 full-width">
        <div class="box current-photos">
            
                <div class="main-image">
                    <picture id="main-image">
                        
        <source srcset="https://omni.harvestcakes.com/media/thumb/product_photos/2022/6/14/9hXMULi2MKSXw3csAykMFz_size_480_webp.webp" type="image/webp">
        <source srcset="https://omni.harvestcakes.com/media/thumb/product_photos/2022/6/14/9hXMULi2MKSXw3csAykMFz_size_480.jpg" type="image/jpeg">
        <img src="https://omni.harvestcakes.com/media/thumb/product_photos/2022/6/14/9hXMULi2MKSXw3csAykMFz_size_480.jpg">
    
                    </picture>
                </div>
                <div class="separator small"></div>
                <div class="pure-g thumbnails">
                    
                        <a href="index.html#" class="pure-u-1-4">
                            <picture class="active">
                                
        <source srcset="https://omni.harvestcakes.com/media/thumb/product_photos/2022/6/14/9hXMULi2MKSXw3csAykMFz_size_480_webp.webp" type="image/webp">
        <source srcset="https://omni.harvestcakes.com/media/thumb/product_photos/2022/6/14/9hXMULi2MKSXw3csAykMFz_size_480.jpg" type="image/jpeg">
        <img src="https://omni.harvestcakes.com/media/thumb/product_photos/2022/6/14/9hXMULi2MKSXw3csAykMFz_size_480.jpg">
    
                            </picture>
                        </a>
                    
                </div>
            
        </div>

        
        <div id='variant-photos-2497' class="box hide">
            
                <div class="main-image">
                    <picture id="main-image">
                        
        <source srcset="https://omni.harvestcakes.com/media/thumb/variant_photos/2022/6/10/3EGgTXh32vUE9eiuu3DQe8_size_480_webp.webp" type="image/webp">
        <source srcset="https://omni.harvestcakes.com/media/thumb/variant_photos/2022/6/10/3EGgTXh32vUE9eiuu3DQe8_size_480.jpg" type="image/jpeg">
        <img src="https://omni.harvestcakes.com/media/thumb/variant_photos/2022/6/10/3EGgTXh32vUE9eiuu3DQe8_size_480.jpg">
    
                    </picture>
                </div>
                <div class="separator small"></div>
                <div class="pure-g thumbnails">
                    
                        <a href="index.html#" class="pure-u-1-4">
                            <picture class="active">
                                
        <source srcset="https://omni.harvestcakes.com/media/thumb/variant_photos/2022/6/10/3EGgTXh32vUE9eiuu3DQe8_size_480_webp.webp" type="image/webp">
        <source srcset="https://omni.harvestcakes.com/media/thumb/variant_photos/2022/6/10/3EGgTXh32vUE9eiuu3DQe8_size_480.jpg" type="image/jpeg">
        <img src="https://omni.harvestcakes.com/media/thumb/variant_photos/2022/6/10/3EGgTXh32vUE9eiuu3DQe8_size_480.jpg">
    
                            </picture>
                        </a>
                    
                </div>
            
        </div>
        
    </div>
    <div class="pure-u-10-24 full-width">
        <div class="box">
        <div class="breadcrumbs website">
            <a href="../../../index.html">Menu</a> > <a href="../../../the-harvest-express/hampers/index.html">Hampers</a>
        </div>
        <div class="separator mobile"></div>
        <div id="out-of-stock-status" class="hide oos">
            <img src="../../../../static/img/oos.png" class="auto-width">
            <span>Out of Stock</span>
        </div>
        <h1>Essential Cookies</h1>
        <div class="current-desc"><p>The first of all cookie packs. An enchanting gift for all occasions.</p></div>
        
            <div class="hide" id="variant-desc-2497">
                <p>The first of all cookie packs. An enchanting gift for all occasions.</p>
            </div>
        
        
        <div id="size_wrapper" class="custom-select hide">
            
            <div class="dropdown flex-container">
                <span class="text">Essential Cookies</span>
            </div>
            <ul class="dropdown-option">
                <li class="sizes flex-container current hide" data-id="2497"
                    data-variant-code="1CK0251"
                    data-use-custom-wording="False"
                    data-price="464000.0"
                    data-discounted-price=""
                    data-discount-percentage="0"
                    data-out-of-stock="False"></li>
            </ul>
            
        </div>
        

        <div id="variant_price" class="price"></div>
        <div class="more-info vertical-align-middle left hide">
            <span class="disc"></span> <span class="original-price line-through"></span>
        </div>
        <div class="add-on-box hide">
            <div class="separator small website"></div>
            <div class="separator small line mobile"></div>
            <h3 id="add_on_label">Choose Add On</h3>
            <div id="add_on_container"></div>
        </div>
        </div>
    </div>
    <div class="pure-u-6-24 full-width no-margin-top">
        <div class="box carts cart-float">
            <div class="separator small line mobile"></div>
            <div class="separator medium mobile"></div>
            <div class="cart-border border-radius">
                <div class="pure-g two-column">
                    <div class="pure-u-1-2">
                        <div class="qty vertical-align-middle top left">
                            <button id="min" class="min">-</button>
                            <input type="number" id="id_quantity" value="1" class="qty-input" disabled>
                            <button id="plus" class="min-plus plus">+</button>
                        </div>
                    </div>
                    <div class="pure-u-1-2 vertical-align-middle right">
                        <strong id="subtotal" class="cart-price">-</strong>
                    </div>
                </div>
                <div class="separator small"></div>
                <p class="notes less-border vertical-align-middle left hide">
                    <img src="../../../../static/img/Edit.png" class="auto">
                    <input id="id_notes" class="id_notes" type="textarea" placeholder="Add wording on your cake" maxlength="30" pattern="[ a-zA-Z0-9]*" title="Only alphanumeric characters are allowed">
                    <span class="hide"><span class="current">0</span>/30</span>
                </p>
                <div class="separator medium"></div>
                <div class="actions">
                    <button id="add-to-cart" type="submit" class="button black">Add to Cart</button>
                    <div class="separator small website"></div>
                    <div class="separator medium mobile"></div>
                    <button id="buy-now"type="submit" class="button pink black">Buy Now</button>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="separator large"></div>
<section class="container text-align-left explore-more " id="explore_more_section">
    <h2 class="small">Explore More</h2>
    
        <div class="container pure-g product-list four-columns hide" id="variant-recommendations-2497">
            
        </div>
    
</section>
<div class="separator vlarge"></div>

    </div>

    <footer>
        <div class="container pure-g">
            <div class="product pure-u-1 pure-u-lg-1-3 box-wrapper">
                <div class="box mobile-center">
                    <img src="../../../../static/img/Logo-Harvest-White.png" class="footer-logo">
                    <img src="../../../../static/img/Logo&#32;Halal&#32;-&#32;Harvest.png" class="halal mobile-hide">
                </div>
            </div>
            <div class="product pure-u-1-2 pure-u-lg-1-6 box-wrapper">
                <div class="box">
                    <h2>THE HARVEST</h2>
                    <div class="links">
                        <a href="../../../../about-us/index.html">About Us</a>
                        <a href="../../../../our-stores/index.html">Stores</a>
                        <a href="../../../../rewards/index.html" class="mobile-hide">Treats</a>
                        <a href="../../../../contact-us/index.html">Contact</a>
                    </div>
                </div>
            </div>
            <div class="product pure-u-1-2 pure-u-lg-1-6 box-wrapper">
                <div class="box website">
                    <h2>HELP CENTER</h2>
                    <div class="links">
                        <a href="../../../../faqs/index.html">FAQ</a>
                        <a href="../../../../terms-and-conditions/index.html">Terms & Conditions</a>
                        <a href="../../../../privacy-policy/index.html">Privacy Policy</a>
                    </div>
                </div>

                <div class="box mobile">
                    <h2>CONTACT US</h2>
                    <div class="links">
                        <a href="tel:1500581"><img src="../../../../static/img/Phone.png"> 1500581</a>
                        <a href="https://wa.me/6281213141500" target="_blank" rel="noopener noreferrer"><img src="../../../../static/img/WA.png"> +62 812 1314 1500</a>
                        <a href="https://www.instagram.com/harvestcakes/" target="_blank" rel="noopener noreferrer"><img src="../../../../static/img/IG.png"> harvestcakes</a>
                        <a href="https://www.facebook.com/theharvestcakes/" target="_blank" rel="noopener noreferrer"><img src="../../../../static/img/Meta.png"> theharvestcakes</a>
                    </div>
                </div>
            </div>
            <div class="product pure-u-1-2 pure-u-lg-1-6 box-wrapper">
                <div class="box website">
                    <h2>CONTACT US</h2>
                    <div class="links">
                        <a href="tel:1500581"><img src="../../../../static/img/Phone.png"> 1500581</a>
                        <a href="https://wa.me/6281213141500" target="_blank" rel="noopener noreferrer"><img src="../../../../static/img/WA.png"> +62 812 1314 1500</a>
                        <a href="https://www.instagram.com/harvestcakes/" target="_blank" rel="noopener noreferrer"><img src="../../../../static/img/IG.png"> harvestcakes</a>
                        <a href="https://www.facebook.com/theharvestcakes/" target="_blank" rel="noopener noreferrer"><img src="../../../../static/img/Meta.png"> theharvestcakes</a>
                    </div>
                </div>
                <div class="box mobile">
                    <h2>HELP CENTER</h2>
                    <div class="links">
                        <a href="../../../../faqs/index.html">FAQ</a>
                        <a href="../../../../terms-and-conditions/index.html">Terms & Conditions</a>
                        <a href="../../../../privacy-policy/index.html">Privacy Policy</a>
                    </div>
                </div>
            </div>
            <div class="product pure-u-1-2 pure-u-lg-1-6 box-wrapper mobile-hide">
                
            </div>
            <div class="product pure-u-1-2 pure-u-lg-1-6 box-wrapper desktop-hide">
                <div class="box">
                    <img src="../../../../static/img/Logo&#32;Halal.png" class="halal">
                </div>
            </div>
        </div>
    </footer>

    <div class="modal-window location hide" id='modal-location'>
        <a href="index.html#" class="close" id='location-close'>
            <img src="../../../../static/img/Close.png" class="modal-close-icon">
        </a>
        <div class="modal-window-box">
            <div class="box border-bottom">
                <h2 class="text-align-center mb-0 large">Select Location</h2>
            </div>
            <div class="box">
                <input type="text" value="" id="search-location" class="search-address" placeholder="Search Location...."/>
                <div class="map" id='map'></div>

                <div class="address-wrapper vertical-align-middle left top">
                    <img src="../../../../static/img/point.png" class="icon-point">
                    <p id="address" class="address middle scroll-section">
                        Jakarta, Indonesia
                    </p>
                </div>
                <div class="separator small"></div>
                <a href="index.html#" id='use-location' class="button pink black center medium auto-width">Use This Location</a>
            </div>
        </div>
    </div>

    <div class="modal-window modal-window-delete hide">
        <a href="index.html#" class="close icon modal-close-delete">
            <img src="../../../../static/img/Close.png" class="modal-close-icon">
        </a>
        <div class="modal-window-box">
            <div class="box border-bottom">
                <h2 class="text-align-center mb-0"></h2>
            </div>
            <div class="box">
                <div class="vertical-align-middle actions-button">
                    <a href="index.html#" class="button full inline-block auto-width transparent modal-close-delete">Cancel</a>
                    <a href="index.html#" class="button full inline-block auto-width pink black modal-window-delete-item">Continue</a>
                </div>
            </div>
        </div>
    </div>

    

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAEgT9WaOpdBGxTjqcqlguxVwtSTaByBqo&libraries=places"></script>
    <script src="../../../../static/CACHE/js/output.c28a16d8843b.js"></script>
    
<script src="../../../../static/tingle.js/dist/tingle.min.js"></script>
<script>
    const addOnBox = document.querySelector('.add-on-box');
    const addOnContainer = document.querySelector('#add_on_container');
    const qtyInput = document.querySelector('#id_quantity');
    const addToCartBtn = document.querySelector('#add-to-cart');
    const buyNowBtn = document.querySelector('#buy-now');
    const updateUrl = '/carts/update-item';
    const notesInput = document.querySelector('#id_notes');
    const thumbnails = document.querySelectorAll('.thumbnails picture');
    // const mainImage = document.getElementById('main-image');
    const plusButton = document.querySelector('#plus');
    const minButton = document.querySelector('#min');
    const variantPriceText = document.querySelector('#variant_price');
    const variantDiscount = document.querySelector('.more-info .disc');
    const variantOriginalPrice = document.querySelector('.more-info .original-price');
    const subtotalText = document.querySelector('#subtotal');
    const customSelect = document.querySelector('.custom-select');
    const selectOptions = customSelect.querySelectorAll('.dropdown-option li');
    const dropdown = customSelect.querySelector('.dropdown');
    const outOfStockStatus = document.querySelector('#out-of-stock-status');
    let selectedOption = null;

    thumbnails.forEach((element) => {
        element.addEventListener('click', (e) => {
            e.preventDefault();
            thumbnails.forEach((element) => {
                element.classList.remove('active');
            });
            element.classList.add('active');
            // eslint-disable-next-line max-len
            const thumbnailParent = element.closest('.thumbnails').parentElement;
            thumbnailParent.querySelector('.main-image img').src = element.lastElementChild.src;
            thumbnailParent.querySelector('.main-image source').srcset = element.lastElementChild.src;
        });
    });

    // eslint-disable-next-line new-cap
    const modal = new tingle.modal({
        footer: true,
        stickyFooter: false,
        onOpen: function() {
            body.classList.add('modal-window-background');
        },
        onClose: function() {
            body.classList.remove('modal-window-background');
        },
        cssClass: ['credit-3ds', 'store-changed'],
    });
    modal.setContent('<h1>Store location has been changed, are you sure want to reset cart?</h1>');
    modal.addFooterBtn('Reset cart', 'tingle-btn tingle-btn--cancel', function() {});
    modal.addFooterBtn('No', 'tingle-btn .tingle-btn--default', function() {
        modal.close();
    });

    function getActiveVariant() {
        return document.querySelector('.sizes.current');
    }

    async function updateModifierChoices(activeVariant) {
        const url = new URL(window.location.origin + '/menus/get-variant-modifiers/');
        url.searchParams.append('id', activeVariant.dataset.id);
        url.searchParams.append('store_id', 97);
        const response = await fetch(url);
        if (response.ok) {
            const payload = await response.json();
            addOnContainer.innerHTML = payload.html;
            if (payload.length > 0) {
                addOnBox.classList.remove('hide');
            } else {
                addOnBox.classList.add('hide');
            }
            updateSubtotal();

            addOnContainer.querySelectorAll('input[name=add_on]').forEach((element) => {
                element.addEventListener('change', (event) => {
                    const group = event.target.closest('.add_on_group');
                    const siblings = group.querySelectorAll('input[name=add_on]:not(:checked)');
                    const count = group.querySelectorAll('input[name=add_on]:checked').length;

                    siblings.forEach((sibling) => {
                        const max = Number.parseInt(group.dataset.max) || 0;
                        sibling.disabled = !!max && count == max;
                    });
                });
            });
        }
    }

    function updatePhotos(activeVariantID) {
        const currentPhotos = document.querySelector('.current-photos');
        const newPhotos = document.querySelector(`#variant-photos-${activeVariantID}`);
        currentPhotos.classList.add('hide');
        currentPhotos.classList.remove('current-photos');
        newPhotos.classList.remove('hide');
        newPhotos.classList.add('current-photos');
    }

    function updateDescription(activeVariantID) {
        const currentDescription = document.querySelector('.current-desc');
        const newDescription = document.querySelector(`#variant-desc-${activeVariantID}`);
        currentDescription.classList.add('hide');
        currentDescription.classList.remove('current-desc');
        newDescription.classList.remove('hide');
        newDescription.classList.add('current-desc');
    }

    function updateRecommendations(activeVariantID) {
        const currentRecommendations = document.querySelector('.current-recommendations');
        const newRecommendations = document.querySelector(`#variant-recommendations-${activeVariantID}`);
        const exploreMoreSection = document.querySelector('#explore_more_section');
        if (currentRecommendations) {
            currentRecommendations.classList.add('hide');
            currentRecommendations.classList.remove('current-recommendations');
        }
        if (newRecommendations && newRecommendations.childElementCount > 0) {
            exploreMoreSection.classList.remove('hide');
            newRecommendations.classList.remove('hide');
            newRecommendations.classList.add('current-recommendations');
        } else {
            exploreMoreSection.classList.add('hide');
        }
    }

    function updateCustomWording(activeVariant) {
        notesInput.value = '';
        if (activeVariant.dataset.useCustomWording === 'True') {
            notesInput.parentNode.classList.remove('hide');
        } else {
            notesInput.parentNode.classList.add('hide');
        }
    }

    function updateOutOfStock(activeVariant) {
        elementToDisable = [
            addOnContainer, minButton.parentElement, notesInput.parentElement,
            addToCartBtn, buyNowBtn,
        ];
        if (activeVariant.dataset.outOfStock == 'True') {
            outOfStockStatus.classList.remove('hide');
            elementToDisable.forEach((element) => {
                element.classList.add('disabled', 'gray-out');
            });
        } else {
            outOfStockStatus.classList.add('hide');
            elementToDisable.forEach((element) => {
                element.classList.remove('disabled', 'gray-out');
            });
        }
    }

    function updatePrice(activeVariant) {
        // reset quantity to 1 when changing variant
        qtyInput.value = 1;
        if (activeVariant.dataset.discountedPrice) {
            variantPriceText.textContent = formatIDR(activeVariant.dataset.discountedPrice);
            variantDiscount.textContent = `${Number.parseInt(activeVariant.dataset.discountPercentage)}%`;
            variantOriginalPrice.textContent = formatIDR(activeVariant.dataset.price);
            variantDiscount.parentElement.classList.remove('hide');
        } else {
            variantPriceText.textContent = formatIDR(activeVariant.dataset.price);
            variantDiscount.parentElement.classList.add('hide');
        }
    }

    function updateVariant() {
        const activeVariant = getActiveVariant();
        if (activeVariant) {
            updateModifierChoices(activeVariant);
            updatePhotos(activeVariant.dataset.id);
            updateDescription(activeVariant.dataset.id);
            updateRecommendations(activeVariant.dataset.id);
            updateCustomWording(activeVariant);
            updateOutOfStock(activeVariant);
            updatePrice(activeVariant);
        } else {
            updateRecommendations(Number.parseInt('None'));
        }
    }
    updateVariant();

    function addToCart(redirectUrl, forceReset) {
        const activeVariant = getActiveVariant();

        const quantity = qtyInput.valueAsNumber;
        const modifiers = {};
        const modifierList = [];

        if (!validateSelectedModifiers()) {
            showMessage('Please choose the correct amount of Add-ons', 'info', false);
            return;
        }

        // Sum selected modifier quantities
        getSelectedModifierInputs().forEach((input) => {
            if (input.value in modifiers) {
                modifiers[input.value] += 1;
            } else {
                modifiers[input.value] = 1;
            }
        });

        for (const [code, quantity] of Object.entries(modifiers)) {
            modifierList.push({
                code: code,
                quantity: quantity,
            });
        }

        let notes;
        if (notesInput) {
            notes = notesInput.value;
        } else {
            notes = '';
        }

        if (!activeVariant) {
            showMessage('Please select size first', 'info');
            return;
        }

        // submit changes to backend
        const payload = {
            code: activeVariant.dataset.variantCode,
            quantity: quantity,
            modifiers: modifierList,
            notes: notes,
            increment: true,
            force_reset: forceReset,
            store_id: 97,
        };
        const request = new Request(updateUrl, {method: 'POST', body: JSON.stringify(payload)});
        fetch(request)
            .then((response) => {
                if (response.ok) {
                    if (redirectUrl) {
                        window.location.href = redirectUrl;
                    } else {
                        showMessage('Essential Cookies added to cart', 'success');
                    }
                }
                return response.json();
            })
            .then((responseData) => {
                if (!responseData) {
                    return;
                }
                if (responseData.items_count) {
                    updateCartItemsCount(responseData.items_count);
                }
                if (responseData.error_code || responseData.error_message) {
                    if (responseData.error_code == 'store_changed') {
                        modal.open();
                        document.querySelector('.tingle-btn.tingle-btn--cancel').addEventListener('click', () => {
                            modal.close();
                            addToCart(redirectUrl, true);
                        });
                    } else if (responseData.error_code == 'login_required') {
                        window.location.href = '/login/?next=/menus/hampers/1306/essential-cookies-2/';
                    } else {
                        showMessage(responseData.error_message, 'warning');
                    }
                }
            });
    }

    function getSelectedModifierInputs() {
        const selectedModifiers = [];
        addOnContainer.querySelectorAll('input[name=add_on]:checked').forEach((element) => {
            selectedModifiers.push(element);
        });
        return selectedModifiers;
    }

    function validateSelectedModifiers() {
        const modifierGroups = Array.from(addOnContainer.querySelectorAll('.add_on_group'));
        return modifierGroups.every((modifierGroup) => {
            const selectedModifiersCount = modifierGroup.querySelectorAll('input[name=add_on]:checked').length;
            const min = Number.parseInt(modifierGroup.dataset.min) || 0;
            const max = Number.parseInt(modifierGroup.dataset.max) || 0;
            return (!min || min <= selectedModifiersCount) && (!max || selectedModifiersCount <= max);
        });
    }

    function updateSubtotal() {
        const activeVariant = getActiveVariant();
        if (activeVariant) {
            let modifierSubtotal = 0;
            const selectedModifiers = getSelectedModifierInputs();
            selectedModifiers.forEach((element) => {
                modifierSubtotal += parseFloat(element.dataset.price);
            });
            const effectivePrice = parseFloat(activeVariant.dataset.discountedPrice || activeVariant.dataset.price);
            const subtotal = (effectivePrice + modifierSubtotal) * qtyInput.valueAsNumber;
            subtotalText.innerHTML = formatIDR(subtotal);
        }
    }

    plusButton.addEventListener('click', () => {
        if (!getActiveVariant()) {
            showMessage('Please select size first', 'info');
            return;
        }
        qtyInput.value = qtyInput.valueAsNumber + 1;
        updateSubtotal();
    });

    minButton.addEventListener('click', () => {
        if (!getActiveVariant()) {
            showMessage('Please select size first', 'info');
            return;
        }
        if (qtyInput.valueAsNumber > 1) {
            qtyInput.value = qtyInput.valueAsNumber - 1;
            updateSubtotal();
        }
    });

    addToCartBtn.addEventListener('click', () => {
        if (notesInput.reportValidity()) {
            addToCart(redirectUrl=null, forceReset=false);
        }
    });
    buyNowBtn.addEventListener('click', () => {
        if (notesInput.reportValidity()) {
            addToCart(redirectUrl='/carts/', forceReset=false);
        }
    });

    dropdown.addEventListener('click', function() {
        dropdown.classList.toggle('active');
    });

    selectOptions.forEach(function(e) {
        e.addEventListener('click', function() {
            if (selectedOption) {
                selectedOption.classList.remove('current');
            }
            selectedOption = e;
            e.classList.add('current');
            dropdown.innerHTML = e.querySelector('#name').innerHTML;
            dropdown.classList.toggle('active');
            updateVariant();
        });
    });

    const notesCharacters = notesInput.nextElementSibling;
    const notesCurrent = notesCharacters.querySelector('.current');
    notesInput.addEventListener('input', () => {
        if (notesInput.value.length > 0) {
            notesCharacters.classList.remove('hide');
        } else {
            notesCharacters.classList.add('hide');
        }
        notesCurrent.innerText = notesInput.value.length;
    });
    notesInput.dispatchEvent(new Event('input'));
</script>

</body>
</html>
